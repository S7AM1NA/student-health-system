{% extends "base.html" %}
{% load static %}

{% block title %}我的健康看板 - {{ block.super }}{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"></script>
{% endblock %}


{% block content %}
    <header class="mb-4">
        <h3>欢迎回来, <span id="username-display" class="text-primary">{{ user.username }}</span>!</h3>
        <p class="text-muted">这是您 <span id="today-date">YYYY-MM-DD</span> 的健康数据概览。</p>
        <div class="row align-items-center mt-3">
            <div class="col-md-auto">
                <p class="text-muted mb-0">查看日期:</p>
            </div>
            <div class="col-md-3">
                <input type="date" class="form-control" id="date-selector">
            </div>
        </div>
    </header>

    <!-- 数据卡片区域 -->
    <div class="row">
        <!-- 睡眠卡片 -->
        <div class="col-md-4 mb-3">
            <div class="card text-center">
                <div class="card-header">
                    <iconify-icon icon="mdi:sleep" class="card-header-icon"></iconify-icon> 睡眠
                </div>
                <div class="card-body">
                    <h5 class="card-title" id="sleep-duration">-- 小时</h5>
                    <p class="card-text text-muted" id="sleep-time-range">未记录</p>
                </div>
            </div>
        </div>

        <!-- 运动卡片 -->
        <div class="col-md-4 mb-3">
            <div class="card text-center">
                <div class="card-header">
                    <iconify-icon icon="material-symbols:directions-run" class="card-header-icon"></iconify-icon> 运动
                </div>
                <div class="card-body">
                    <h5 class="card-title"><span id="calories-burned">--</span> 大卡</h5>
                    <p class="card-text text-muted" id="sport-details">今日暂无运动</p>
                </div>
            </div>
        </div>

        <!-- 饮食卡片 -->
        <div class="col-md-4 mb-3">
            <div class="card text-center">
                <div class="card-header">
                    <iconify-icon icon="ic:baseline-restaurant" class="card-header-icon"></iconify-icon> 饮食
                </div>
                <div class="card-body">
                    <h5 class="card-title"><span id="calories-eaten">--</span> 大卡</h5>
                    <p class="card-text text-muted" id="diet-details">今日暂无饮食记录</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 今日目标进度区域 -->
    <div class="mt-4" id="goals-section">
        <h4 class="mb-3">今日目标进度</h4>
        <div class="card">
            <div class="card-body">
                <div id="goals-progress-container" class="row text-center pt-3">
                    
                    <div class="col-md-4">
                        <div class="chart-container">
                            <canvas id="sleep-goal-chart"></canvas>
                        </div>
                        <h6 class="mt-3">睡眠时长</h6>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="chart-container">
                            <canvas id="sport-goal-chart"></canvas>
                        </div>
                        <h6 class="mt-3">运动消耗</h6>
                    </div>

                    <div class="col-md-4">
                        <div class="chart-container">
                            <canvas id="diet-goal-chart"></canvas>
                        </div>
                        <h6 class="mt-3">饮食摄入</h6>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- 健康小结区域 -->
    <div class="mt-4 alert alert-info" id="health-summary">
        <h4 class="alert-heading">今日小结</h4>
        <p id="summary-suggestion">正在分析您的健康数据...</p>
    </div>
{% endblock %}


{% block extra_js %}
    <!-- 引入CountUp.js -->
    <script src="https://cdn.jsdelivr.net/npm/countup.js@2.8.0/dist/countUp.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 引入你自己的dashboard.js，使用规范的static标签 -->
    <script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}